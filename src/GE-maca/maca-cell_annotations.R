############### SYNOPSIS ###################
# Get cell_type annotations

### OUTPUT: 
# ....

### REMARKS:
# ....

### REFERENCE:

# ======================================================================= #
# ==============================  USAGE  =============================== #
# ======================================================================= #


# ======================================================================= #
# ==============================  SETUP  =============================== #
# ======================================================================= #

library(tidyverse)

# ======================================================================= #
# ============================  PARAMS  ============================== #
# ======================================================================= #

wd <- "/raid5/projects/timshel/sc-genetics/sc-genetics/src/GE-maca/"
setwd(wd)

# ======================================================================= #
# ============================  INITIALIZE  ============================== #
# ======================================================================= #

### Load data
# file.RData.cell_atlas <- "/projects/timshel/maca/data/figshare/180126-facs/maca.seurat_obj.facs.figshare_180126.RData" # 6.1 GB | seurat_obj
# load(file.RData.cell_atlas) 

# ======================================================================= #
# ============================  MAIN  ============================== #
# ======================================================================= #

# df.annotation <- read_csv("/data/pub-others/tabula_muris/figshare/180126-facs/metadata_FACS.csv")
df.annotation <- read_csv("/data/pub-others/tabula_muris/figshare/180126-facs/annotations_FACS.csv")

df.summary <- df.annotation %>% distinct(tissue, cell_ontology_class)


# ======================================================================= #
# ============================  GTEX (tmp)  ============================== #
# ======================================================================= #

file.annotations <- "/data/rna-seq/gtex/v7/GTEx_v7_Annotations_SampleAttributesDS.txt"
df.annot <- read_delim(file.annotations, delim="\t")
df.summary <- df.annot %>% distinct(SMTS, SMTSD)



